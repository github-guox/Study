# 197. 上升的温度

https://leetcode-cn.com/problems/rising-temperature/ <br/>

```wiki
给定一个 Weather 表，编写一个 SQL 查询，来查找与之前（昨天的）日期相比温度更高的所有日期的 Id。
+---------+------------------+------------------+
| Id(INT) | RecordDate(DATE) | Temperature(INT) |
+---------+------------------+------------------+
|       1 |       2015-01-01 |               10 |
|       2 |       2015-01-02 |               25 |
|       3 |       2015-01-03 |               20 |
|       4 |       2015-01-04 |               30 |
+---------+------------------+------------------+
例如，根据上述给定的 Weather 表格，返回如下 Id:
+----+
| Id |
+----+
|  2 |
|  4 |
+----+
```



### 知识点

DATEDIFF() 函数返回两个日期之间的时间。<br/>

```mysql
DATEDIFF(datepart,startdate,enddate)
```

*startdate* 和 *enddate* 参数是合法的日期表达式。<br/>

*datepart* 参数可以是下列的值：<br/>

| datepart | 缩写     |
| :------- | :------- |
| 年       | yy, yyyy |
| 季度     | qq, q    |
| 月       | mm, m    |
| 年中的日 | dy, y    |
| 日       | dd, d    |
| 周       | wk, ww   |
| 星期     | dw, w    |
| 小时     | hh       |
| 分钟     | mi, n    |
| 秒       | ss, s    |
| 毫秒     | ms       |
| 微妙     | mcs      |
| 纳秒     | ns       |

**实例** <br/>

```mysql
SELECT DATEDIFF(day,'2008-12-29','2008-12-30') AS DiffDate
```

| DATEDIFF |
| :------- |
| 1        |

```mysql
SELECT DATEDIFF(day,'2008-12-30','2008-12-29') AS DiffDate
```

| DATEDIFF |
| :------- |
| -1       |

```wiki
使用datediff方法会得到一个long类型的数字，但这个数字对毫秒和秒得出的最大值是有限制的。
1. 对于毫秒最大数是24天20小时31分零23.647秒。
2. 对于秒最大数是68年。
如果超过最大值的话，会有如下错误信息显示：Difference of two datetime fields caused overflow at runtime.
不遇到一次很难会想到这点，建议尽量用秒就好。
```

```mysql
SELECT w1.Id 
FROM Weather w1, Weather w2
WHERE 
    DATEDIFF(w1.RecordDate, w2.RecordDate)=1 AND w1.Temperature>w2.Temperature;
```

为什么是`DATEDIFF(w1.RecordDate, w2.RecordDate)=1` ，我觉的应该是`=-1`？<br/>

****



```mysql
SELECT w1.Id 
FROM Weather w1, Weather w2
WHERE 
    w1.RecordDate=w2.RecordDate+1 AND w1.Temperature>w2.Temperature;
```

上述代码，**13 / 14** 个通过测试用例。<br/>

```wiki
{"headers":["Id"],"values":[[1116],[191],[497],[268],[926],[945],[946],[1126],[265],[112],[615],[994],[439],[56],[154],[1109],[1132],[106],[331],[1011],[170],[99],[414],[812],[93],[659],[1072],[1150],[977],[968],[504],[477],[167],[962],[600],[81],[953],[222],[1190],[386],[168],[334],[473],[542],[696],[1027],[707],[215],[952],[67],[695],[942],[947],[471],[204],[642],[736],[1042],[347],[1131],[104],[708],[438],[929],[543],[231],[976],[206],[117],[1001],[387],[753],[499],[1000],[229],[1083],[138],[1036],[898],[927],[162],[165],[433],[749],[901],[135],[368],[842],[859],[124],[577],[87],[1125],[19],[648],[403],[340],[426],[803],[228],[37],[297],[928],[879],[1091],[1017],[1195],[569],[254],[519],[13],[558],[555],[575],[127],[466],[531],[394],[1182],[734],[1165],[116],[911],[434],[239],[1153],[481],[1035],[900],[1099],[819],[692],[1135],[668],[273],[410],[82],[510],[401],[1142],[43],[923],[218],[208],[940],[720],[874],[562],[1085],[65],[1118],[752],[576],[1021],[1133],[631],[243],[989],[382],[1038],[750],[1177],[864],[931],[84],[1197],[719],[444],[580],[61],[1196],[452],[455],[1104],[872],[480],[91],[1090],[1180],[353],[914],[1129],[1187],[200],[795],[829],[337],[1102],[79],[540],[718],[820],[125],[760],[1033],[298],[74],[988],[957],[1080],[512],[902],[563],[216],[764],[329],[278],[242],[283],[891],[1030],[548],[134],[48],[299],[290],[771],[324],[1048],[790],[333],[47],[966],[456],[39],[848],[343],[877],[49],[326],[392],[520],[373],[310],[277],[630],[1088],[759],[1064],[1061],[763],[741],[288],[698],[623],[1139],[1031],[171],[550],[616],[1189],[745],[673],[1184],[608],[644],[1162],[1119],[354],[709],[955],[97],[910],[29],[560],[223],[693],[676],[817],[686],[198],[1020],[592],[655],[614],[511],[113],[1076],[1084],[163],[199],[850],[853],[153],[14],[857],[997],[779],[227],[549],[18],[986],[1052],[186],[995],[503],[435],[629],[755],[612],[1154],[506],[657],[1065],[781],[196],[965],[232],[1059],[50],[904],[381],[359],[213],[761],[517],[25],[451],[836],[77],[844],[846],[579],[603],[233],[1093],[1193],[390],[332],[882],[782],[467],[409],[90],[565],[120],[12],[835],[1050],[621],[748],[341],[484],[1002],[815],[956],[30],[726],[89],[1164],[1159],[983],[488],[934],[1005],[1046],[249],[1055],[610],[291],[294],[728],[862],[769],[1054],[210],[876],[303],[398]]}
```



预期：<br/>

```wiki
{"headers":["Id"],"values":[[1116],[191],[497],[268],[926],[945],[946],[1126],[265],[112],[615],[994],[439],[56],[154],[1109],[1132],[106],[331],[1011],[170],[99],[414],[812],[93],[659],[1072],[1150],[977],[968],[504],[407],[477],[167],[962],[600],[81],[953],[507],[222],[1190],[386],[168],[334],[473],[542],[696],[1027],[707],[215],[952],[67],[695],[942],[947],[471],[204],[642],[736],[1042],[347],[1131],[104],[708],[438],[929],[543],[231],[976],[206],[117],[1001],[387],[753],[499],[1000],[229],[1083],[295],[138],[1036],[898],[921],[927],[162],[165],[225],[433],[749],[901],[135],[368],[842],[859],[124],[577],[87],[1125],[19],[648],[403],[340],[426],[803],[228],[37],[297],[928],[879],[1091],[1017],[1195],[569],[254],[519],[13],[1167],[558],[555],[575],[127],[466],[531],[394],[1182],[734],[1165],[116],[911],[434],[239],[1153],[481],[1035],[900],[1099],[819],[692],[1135],[668],[273],[410],[82],[510],[401],[1142],[43],[923],[218],[208],[462],[940],[720],[874],[562],[1085],[65],[1118],[752],[576],[1021],[1133],[631],[243],[989],[382],[1038],[750],[1177],[864],[931],[84],[1197],[719],[444],[580],[61],[1196],[452],[455],[1104],[925],[872],[480],[91],[1090],[1180],[353],[914],[1129],[1187],[200],[795],[829],[337],[1102],[79],[540],[718],[820],[125],[760],[1033],[298],[74],[988],[957],[1080],[512],[902],[563],[216],[764],[329],[278],[242],[283],[891],[1030],[875],[548],[134],[48],[299],[290],[771],[324],[1048],[178],[790],[333],[47],[966],[456],[39],[848],[343],[877],[49],[326],[392],[520],[373],[310],[1112],[277],[630],[1088],[759],[1064],[1061],[763],[741],[288],[698],[623],[1139],[1031],[171],[550],[397],[616],[1189],[745],[673],[1184],[608],[644],[1162],[1119],[354],[709],[955],[97],[910],[29],[560],[223],[693],[676],[817],[686],[198],[1020],[592],[655],[614],[511],[113],[1076],[1084],[163],[199],[850],[853],[153],[14],[857],[997],[779],[227],[549],[18],[986],[1052],[186],[995],[503],[435],[629],[755],[612],[1154],[506],[657],[1065],[781],[196],[965],[232],[1059],[50],[904],[381],[359],[213],[761],[517],[25],[451],[836],[77],[625],[844],[846],[579],[603],[233],[1093],[1193],[390],[332],[882],[782],[467],[409],[90],[565],[120],[12],[835],[1050],[621],[748],[341],[484],[1002],[815],[956],[30],[726],[89],[1164],[1159],[983],[488],[934],[1005],[1046],[249],[1055],[610],[291],[294],[728],[862],[769],[1054],[210],[876],[303],[398]]}
```

















